**什么是事务**

逻辑上的一组操作，要么都执行，要么都不执行。

事务最经典也经常被拿来说得例子就是转账了。假如小明要给小红转账1000元，这个转账会涉及到两个关键的操作：1.将小明的余额减少1000元；2将小红的余额增加1000元。万一在这两个操作之间突然出现了错误，比如说银行系统崩溃，导致小明余额减少然而小红的余额没有增加，这样就不对了。事务就是保证两个关键操作要么都成功，要么都失败。

**事务的四大特性（ACID)**

1. **原子性**：事务是最小的执行单元，不予许分割。
2. **一致性**：
3. **隔离性**：并发方位
4. **持久性**：

**并发事务带来哪些问题**

在典型的应用程序中，多个事务并发运行，经常会操作相同的数据来完成各自的任务（多个用户对同一数据进行操作）。并发虽然是必须的，但可能会带来下列问题。

1. **脏读**：

2. **不可重复读**：

3. **幻读**：幻读和不可重复读类似。它发生在一个事务（T1）读取了几行数据，接着另一个并发事务（T2）插入了一些数据时。在随后的查询中，读一个事务（T1）就会发现多了一些原本不存在的记录，就好像发生了幻觉一样，所以称之为幻读。

   **事务隔离级别有哪些？Mysql默认隔离级别是？**

   **SQL标准定义了4个隔离级别:**

   **READ-UNCOMMITED(读取未提交):**最低的隔离级别，允许读取尚未提交的数据变更，可能会导致**脏读、不可重复读，幻读**.

   **READ-COMMITED（读取已提交)：**		

   **REPEATABLE-READ（可重复读）:**	对同一个字段的读取结果都是一致的，除非数据是被本身事务自己所修改，可以阻止**脏读和不可重复读，但幻读仍有可能发生。**	

   **SERIALIZABLE（可串行读）:**	最高的隔离级别，完全服从ACID的隔离级别。所有的事务依次逐个执行，这样事务之间就完全不可能产生干扰，也就是说，**该级别可以防止脏读、不可重复读以及幻读。**	

   mysql InnoDB 存储引擎的默认支持的隔离级别是 **REPEATABLE-READ(可重复读)**	。同时使用Next-Key Lock锁算法，因此可以避免幻读的产生，这与其他数据库系统是不同的。所以说InnoDB存储引擎已经可以完全保证事物的隔离性要求，即达到SQL标准的**SERIALIZABLE（可串行读）**	隔离级别。因为事务的隔壁级别越低，要求的锁越少，性能也就越高。InnoDB存储引擎在分布式事务的情况下一般会用到**SERIALIZABLE(可串行读)**	隔离级别。



**大表优化**

当mysql单表记录数过大时，数据库的CRUD性能会明显下降，一些常见的优化措施如下：

**1.限定数据的范围**

务必禁止不带任何限制数据范围条件的查询语句。比如当用户查询订单历史的时候，我们可以控制在一个月的范围内；

**2.读/写分离**

经典的数据库拆分方案，主库负责写，从库负责读；

**3.垂直分区**

**根据数据库里面数据表的相关性进行拆分。**	例如，用户表中既有用户的登录信息又有用户的基本信息，可以将用户表拆分成两个单独的表，甚至放到单独的库做分库。

**简单来说垂直拆分是指数据表列的拆分，把一张列比较多的表拆分成多个表。**	

- 垂直拆分的优点：可以使得列数据表变小，在查询时减少读取的block数，减少I/O次数。此外，垂直分区可以简化表的结构，易于维护。
- 垂直拆分的缺点：主键会出现冗余，需要管理冗余列，并会引起join操作，可以通过在应用层进行Join来解决。此外，垂直分区会让事务变得更加复杂。

**4.水平分区**



